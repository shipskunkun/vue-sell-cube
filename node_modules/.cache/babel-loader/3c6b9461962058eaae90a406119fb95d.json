{"remainingRequest":"/Users/leeco/Documents/vue-sell-cube/node_modules/babel-loader/lib/index.js??ref--16-1!/Users/leeco/Documents/vue-sell-cube/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/leeco/Documents/vue-sell-cube/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/leeco/Documents/vue-sell-cube/node_modules/cube-ui/src/components/image-preview/image-preview.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/leeco/Documents/vue-sell-cube/node_modules/cube-ui/src/components/image-preview/image-preview.vue","mtime":499162500000},{"path":"/Users/leeco/Documents/vue-sell-cube/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/leeco/Documents/vue-sell-cube/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/leeco/Documents/vue-sell-cube/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/leeco/Documents/vue-sell-cube/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Users/leeco/Documents/vue-sell-cube/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/leeco/Documents/vue-sell-cube/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/leeco/Documents/vue-sell-cube/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/leeco/Documents/vue-sell-cube/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport CubePopup from '../popup/popup.vue';\nimport CubeSlide from '../slide/slide.vue';\nimport CubeSlideItem from '../slide/slide-item.vue';\nimport CubeScroll from '../scroll/scroll.vue';\nimport visibilityMixin from '../../common/mixins/visibility';\nimport popupMixin from '../../common/mixins/popup';\nimport { isAndroid } from '../../common/helpers/env';\nvar COMPONENT_NAME = 'cube-image-preview';\nvar EVENT_CHANGE = 'change';\nvar EVENT_HIDE = 'hide';\nexport default {\n  name: COMPONENT_NAME,\n  mixins: [visibilityMixin, popupMixin],\n  props: {\n    initialIndex: {\n      type: Number,\n      default: 0\n    },\n    imgs: {\n      type: Array,\n      default: function _default() {\n        /* istanbul ignore next */\n        return [];\n      }\n    },\n    loop: {\n      type: Boolean,\n      default: true\n    },\n    speed: {\n      type: Number,\n      default: 400\n    },\n    preventDefault: {\n      type: Boolean,\n      default: true\n    }\n  },\n  data: function data() {\n    return {\n      currentPageIndex: this.initialIndex,\n      options: {\n        observeDOM: false,\n        bounce: {\n          left: true,\n          right: true\n        },\n        useTransition: !isAndroid,\n        probeType: 3,\n        preventDefault: this.preventDefault\n      },\n      scrollOptions: {\n        HWCompositing: isAndroid,\n        observeDOM: false,\n        zoom: true,\n        bindToWrapper: true,\n        freeScroll: true,\n        scrollX: true,\n        scrollY: true,\n        probeType: 3,\n        bounce: false,\n        click: false,\n        dblclick: true,\n        bounceTime: 300,\n        preventDefault: this.preventDefault\n      }\n    };\n  },\n  watch: {\n    initialIndex: function initialIndex(newIndex) {\n      this.setPageIndex(newIndex);\n    }\n  },\n  methods: {\n    show: function show() {\n      var _this = this;\n\n      this.isVisible = true;\n      this.$nextTick(function () {\n        _this._listenSlide();\n\n        _this._listenScroll();\n      });\n    },\n    _listenSlide: function _listenSlide() {\n      var _this2 = this;\n\n      // waiting slide initial\n      this.$nextTick(function () {\n        var slide = _this2.$refs.slide.slide;\n        slide.on('scrollStart', _this2.slideScrollStartHandler);\n        slide.on('scrollEnd', _this2.slideScrollEndHandler);\n      });\n    },\n    _listenScroll: function _listenScroll() {\n      var _this3 = this;\n\n      // waiting scroll initial\n      this.$nextTick(function () {\n        _this3.$refs.items.forEach(function (scrollItem) {\n          var scroll = scrollItem.scroll;\n          scroll.on('zoomStart', _this3.zoomStartHandler.bind(_this3, scroll));\n          scroll.on('beforeScrollStart', _this3.beforeScrollHandler);\n          scroll.on('scroll', _this3.checkBoundary.bind(_this3, scroll));\n          scroll.on('scrollEnd', _this3.scrollEndHandler.bind(_this3, scroll));\n        });\n      });\n    },\n    hide: function hide() {\n      this.isVisible = false;\n      this.$emit(EVENT_HIDE);\n    },\n    prev: function prev() {\n      var slide = this.$refs.slide.slide;\n      slide && slide.prev();\n    },\n    next: function next() {\n      var slide = this.$refs.slide.slide;\n      slide && slide.next();\n    },\n    goTo: function goTo(index) {\n      var slide = this.$refs.slide.slide;\n      slide && slide.goToPage(index, 0);\n    },\n    imgLoad: function imgLoad(i) {\n      /* istanbul ignore if */\n      if (this.isVisible && this.$refs.items) {\n        this.$refs.items[i].scroll.refresh();\n      }\n    },\n    setPageIndex: function setPageIndex(currentPageIndex) {\n      if (this.currentPageIndex >= 0 && this.currentPageIndex !== currentPageIndex) {\n        var item = this.$refs.items[this.currentPageIndex];\n\n        if (item) {\n          var scroll = item.scroll;\n          /* istanbul ignore if */\n\n          if (scroll.scale !== 1) {\n            scroll.scale = 1;\n            scroll.lastcale = 1;\n            scroll.refresh();\n          }\n        }\n      }\n\n      this.currentPageIndex = currentPageIndex;\n    },\n    slideChangeHandler: function slideChangeHandler(currentPageIndex) {\n      this.setPageIndex(currentPageIndex);\n      this.slideScrollEndHandler();\n      this.$emit(EVENT_CHANGE, currentPageIndex);\n    },\n    slideScrollStartHandler: function slideScrollStartHandler() {\n      var slide = this.$refs.slide.slide;\n\n      if (this._scrolling && !this._hasEnableSlide) {\n        slide.disable();\n      } else {\n        slide.enable();\n      }\n    },\n    slideScrollEndHandler: function slideScrollEndHandler() {\n      var _this4 = this;\n\n      this.$refs.items.forEach(function (scrollItem) {\n        _this4.scrollEndHandler(scrollItem.scroll);\n      });\n    },\n    _scroll: function _scroll(scroll) {\n      var slide = this.$refs.slide.slide;\n      slide.disable();\n      slide.refresh();\n      scroll.enable();\n    },\n    _slide: function _slide(scroll) {\n      this.$refs.slide.slide.enable();\n      scroll.disable();\n    },\n    beforeScrollHandler: function beforeScrollHandler() {\n      // for touchstart scrollEnd\n      // cancel it, do not enable slide\n      clearTimeout(this.enableSlideTid);\n    },\n    scrollEndHandler: function scrollEndHandler(scroll) {\n      var _this5 = this;\n\n      clearTimeout(this.enableSlideTid);\n\n      if (this.dblZooming) {\n        this.dblZooming = false;\n        clearTimeout(this.clickTid);\n      }\n\n      this._hasEnableSlide = false;\n      this._scrolling = false;\n      scroll.enable();\n      this.enableSlideTid = setTimeout(function () {\n        _this5.$refs.slide.slide.enable();\n      });\n    },\n    checkBoundary: function checkBoundary(scroll, pos) {\n      if (scroll.distX && Math.abs(scroll.distX) > Math.abs(scroll.distY)) {\n        this._scrolling = true;\n        var reached = scroll.distX > 0 ? pos.x >= scroll.minScrollX : pos.x <= scroll.maxScrollX;\n\n        if (reached) {\n          this._hasEnableSlide = true;\n\n          this._slide(scroll);\n        } else {\n          if (!this._hasEnableSlide) {\n            this._scroll(scroll);\n          }\n        }\n      } else if (scroll.distY) {\n        this._scrolling = true;\n\n        this._scroll(scroll);\n      }\n    },\n    zoomStartHandler: function zoomStartHandler(scroll) {\n      this._scroll(scroll);\n    },\n    dblclickHandler: function dblclickHandler(index, e) {\n      var scroll = this.$refs.items[index].scroll;\n      this.dblZooming = true;\n      this.zoomTo(scroll, scroll.scale > 1 ? 1 : 2, e);\n      scroll.disable();\n    },\n    itemClickHandler: function itemClickHandler() {\n      var _this6 = this;\n\n      clearTimeout(this.clickTid);\n      this.clickTid = setTimeout(function () {\n        !_this6.dblZooming && _this6.hide();\n      }, this.scrollOptions.bounceTime);\n    },\n    zoomTo: function zoomTo(scroll, scale, e) {\n      scroll.zoomTo(scale, e.pageX, e.pageY);\n    }\n  },\n  components: {\n    CubePopup: CubePopup,\n    CubeSlide: CubeSlide,\n    CubeSlideItem: CubeSlideItem,\n    CubeScroll: CubeScroll\n  }\n};",{"version":3,"sources":["image-preview.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <transition name=\"cube-image-preview-fade\">\n    <cube-popup type=\"image-preview\" :z-index=\"zIndex\" :center=\"false\" v-show=\"isVisible\">\n      <div class=\"cube-image-preview-container\">\n        <div class=\"cube-image-preview-header\">\n          <slot name=\"header\" :current=\"currentPageIndex\"></slot>\n        </div>\n        <cube-slide\n          ref=\"slide\"\n          v-if=\"isVisible\"\n          :data=\"imgs\"\n          :initial-index=\"currentPageIndex\"\n          :auto-play=\"false\"\n          :loop=\"loop\"\n          :speed=\"speed\"\n          :options=\"options\"\n          @change=\"slideChangeHandler\"\n        >\n          <cube-slide-item\n            v-for=\"(img, index) in imgs\"\n            :key=\"index\"\n          >\n            <div class=\"cube-image-preview-item\" @click=\"itemClickHandler\">\n              <cube-scroll\n                ref=\"items\"\n                :options=\"scrollOptions\"\n                @dblclick.native=\"dblclickHandler(index, $event)\"\n              >\n                <img class=\"cube-image-preview-img\" :src=\"img\" @load=\"imgLoad(index)\">\n              </cube-scroll>\n            </div>\n          </cube-slide-item>\n          <template slot=\"dots\"><i></i></template>\n        </cube-slide>\n        <div class=\"cube-image-preview-footer\">\n          <slot name=\"footer\" :current=\"currentPageIndex\">\n            <span class=\"cube-image-preview-counter\">{{currentPageIndex + 1}}/{{imgs.length}}</span>\n          </slot>\n        </div>\n      </div>\n    </cube-popup>\n  </transition>\n</template>\n<script type=\"text/ecmascript-6\">\n  import CubePopup from '../popup/popup.vue'\n  import CubeSlide from '../slide/slide.vue'\n  import CubeSlideItem from '../slide/slide-item.vue'\n  import CubeScroll from '../scroll/scroll.vue'\n  import visibilityMixin from '../../common/mixins/visibility'\n  import popupMixin from '../../common/mixins/popup'\n  import { isAndroid } from '../../common/helpers/env'\n\n  const COMPONENT_NAME = 'cube-image-preview'\n  const EVENT_CHANGE = 'change'\n  const EVENT_HIDE = 'hide'\n\n  export default {\n    name: COMPONENT_NAME,\n    mixins: [visibilityMixin, popupMixin],\n    props: {\n      initialIndex: {\n        type: Number,\n        default: 0\n      },\n      imgs: {\n        type: Array,\n        default() {\n          /* istanbul ignore next */\n          return []\n        }\n      },\n      loop: {\n        type: Boolean,\n        default: true\n      },\n      speed: {\n        type: Number,\n        default: 400\n      },\n      preventDefault: {\n        type: Boolean,\n        default: true\n      }\n    },\n    data() {\n      return {\n        currentPageIndex: this.initialIndex,\n        options: {\n          observeDOM: false,\n          bounce: {\n            left: true,\n            right: true\n          },\n          useTransition: !isAndroid,\n          probeType: 3,\n          preventDefault: this.preventDefault\n        },\n        scrollOptions: {\n          HWCompositing: isAndroid,\n          observeDOM: false,\n          zoom: true,\n          bindToWrapper: true,\n          freeScroll: true,\n          scrollX: true,\n          scrollY: true,\n          probeType: 3,\n          bounce: false,\n          click: false,\n          dblclick: true,\n          bounceTime: 300,\n          preventDefault: this.preventDefault\n        }\n      }\n    },\n    watch: {\n      initialIndex(newIndex) {\n        this.setPageIndex(newIndex)\n      }\n    },\n    methods: {\n      show() {\n        this.isVisible = true\n        this.$nextTick(() => {\n          this._listenSlide()\n          this._listenScroll()\n        })\n      },\n      _listenSlide() {\n        // waiting slide initial\n        this.$nextTick(() => {\n          const slide = this.$refs.slide.slide\n          slide.on('scrollStart', this.slideScrollStartHandler)\n          slide.on('scrollEnd', this.slideScrollEndHandler)\n        })\n      },\n      _listenScroll() {\n        // waiting scroll initial\n        this.$nextTick(() => {\n          this.$refs.items.forEach((scrollItem) => {\n            const scroll = scrollItem.scroll\n            scroll.on('zoomStart', this.zoomStartHandler.bind(this, scroll))\n            scroll.on('beforeScrollStart', this.beforeScrollHandler)\n            scroll.on('scroll', this.checkBoundary.bind(this, scroll))\n            scroll.on('scrollEnd', this.scrollEndHandler.bind(this, scroll))\n          })\n        })\n      },\n      hide() {\n        this.isVisible = false\n        this.$emit(EVENT_HIDE)\n      },\n      prev() {\n        const slide = this.$refs.slide.slide\n        slide && slide.prev()\n      },\n      next() {\n        const slide = this.$refs.slide.slide\n        slide && slide.next()\n      },\n      goTo(index) {\n        const slide = this.$refs.slide.slide\n        slide && slide.goToPage(index, 0)\n      },\n      imgLoad(i) {\n        /* istanbul ignore if */\n        if (this.isVisible && this.$refs.items) {\n          this.$refs.items[i].scroll.refresh()\n        }\n      },\n      setPageIndex(currentPageIndex) {\n        if (this.currentPageIndex >= 0 && this.currentPageIndex !== currentPageIndex) {\n          const item = this.$refs.items[this.currentPageIndex]\n          if (item) {\n            const scroll = item.scroll\n            /* istanbul ignore if */\n            if (scroll.scale !== 1) {\n              scroll.scale = 1\n              scroll.lastcale = 1\n              scroll.refresh()\n            }\n          }\n        }\n        this.currentPageIndex = currentPageIndex\n      },\n      slideChangeHandler(currentPageIndex) {\n        this.setPageIndex(currentPageIndex)\n        this.slideScrollEndHandler()\n        this.$emit(EVENT_CHANGE, currentPageIndex)\n      },\n      slideScrollStartHandler() {\n        const slide = this.$refs.slide.slide\n        if (this._scrolling && !this._hasEnableSlide) {\n          slide.disable()\n        } else {\n          slide.enable()\n        }\n      },\n      slideScrollEndHandler() {\n        this.$refs.items.forEach((scrollItem) => {\n          this.scrollEndHandler(scrollItem.scroll)\n        })\n      },\n      _scroll(scroll) {\n        const slide = this.$refs.slide.slide\n        slide.disable()\n        slide.refresh()\n        scroll.enable()\n      },\n      _slide(scroll) {\n        this.$refs.slide.slide.enable()\n        scroll.disable()\n      },\n      beforeScrollHandler() {\n        // for touchstart scrollEnd\n        // cancel it, do not enable slide\n        clearTimeout(this.enableSlideTid)\n      },\n      scrollEndHandler(scroll) {\n        clearTimeout(this.enableSlideTid)\n        if (this.dblZooming) {\n          this.dblZooming = false\n          clearTimeout(this.clickTid)\n        }\n        this._hasEnableSlide = false\n        this._scrolling = false\n        scroll.enable()\n        this.enableSlideTid = setTimeout(() => {\n          this.$refs.slide.slide.enable()\n        })\n      },\n      checkBoundary(scroll, pos) {\n        if (scroll.distX && Math.abs(scroll.distX) > Math.abs(scroll.distY)) {\n          this._scrolling = true\n          const reached = scroll.distX > 0 ? pos.x >= scroll.minScrollX : pos.x <= scroll.maxScrollX\n          if (reached) {\n            this._hasEnableSlide = true\n            this._slide(scroll)\n          } else {\n            if (!this._hasEnableSlide) {\n              this._scroll(scroll)\n            }\n          }\n        } else if (scroll.distY) {\n          this._scrolling = true\n          this._scroll(scroll)\n        }\n      },\n      zoomStartHandler(scroll) {\n        this._scroll(scroll)\n      },\n      dblclickHandler(index, e) {\n        const scroll = this.$refs.items[index].scroll\n        this.dblZooming = true\n        this.zoomTo(scroll, scroll.scale > 1 ? 1 : 2, e)\n        scroll.disable()\n      },\n      itemClickHandler() {\n        clearTimeout(this.clickTid)\n        this.clickTid = setTimeout(() => {\n          !this.dblZooming && this.hide()\n        }, this.scrollOptions.bounceTime)\n      },\n      zoomTo(scroll, scale, e) {\n        scroll.zoomTo(scale, e.pageX, e.pageY)\n      }\n    },\n    components: {\n      CubePopup,\n      CubeSlide,\n      CubeSlideItem,\n      CubeScroll\n    }\n  }\n</script>\n<style lang=\"stylus\" rel=\"stylesheet/stylus\">\n  @require \"../../common/stylus/variable.styl\"\n\n  .cube-image-preview-fade-enter, .cube-image-preview-fade-leave-active\n    opacity: 0\n  .cube-image-preview-fade-enter-active, .cube-image-preview-fade-leave-active\n    transition: all .3s ease-in-out\n\n  .cube-image-preview\n    .cube-popup-mask\n      opacity: .6\n    .cube-popup-content\n      width: 100%\n      height: 100%\n    .cube-slide-item\n      display: flex\n      align-items: center\n      justify-content: center\n      overflow: hidden\n  .cube-image-preview-container\n    height: 100%\n    margin: 0 -10px\n  .cube-image-preview-header,\n  .cube-image-preview-footer\n    position: absolute\n    left: 0\n    right: 0\n  .cube-image-preview-header\n    top: 0\n  .cube-image-preview-footer\n    bottom: 0\n  .cube-image-preview-counter\n    position: absolute\n    bottom: 50px\n    width: 100%\n    text-align: center\n    font-size: $fontsize-medium\n    color: $image-preview-counter-color\n  .cube-image-preview-item\n    position: relative\n    padding: 0 10px\n    width: 100%\n    height: 100%\n    .cube-scroll-wrapper\n      display: flex\n      align-items: center\n      justify-content: center\n    .cube-image-preview-img\n      display: block\n      height: auto\n      max-width: 100%\n      max-height: 100%\n</style>\n"],"sourceRoot":"node_modules/cube-ui/src/components/image-preview"}]}